{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ajits\\\\fastapi-react-chatbot\\\\frontend\\\\src\\\\components\\\\MessageBubble.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { messageVariants } from '../styles/variants';\nimport TypingIndicator from './TypingIndicator';\nimport ReactMarkdown from 'react-markdown';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MessageBubble = ({\n  message,\n  isUser,\n  isTyping = false,\n  character,\n  error\n}) => {\n  _s();\n  const [displayText, setDisplayText] = useState('');\n  const [showTyping, setShowTyping] = useState(isTyping);\n  const [isVisible, setIsVisible] = useState(true);\n  const bubbleRef = useRef(null);\n  useEffect(() => {\n    if (isTyping) {\n      setShowTyping(true);\n      if (!message.trim()) {\n        setDisplayText('');\n      }\n    } else {\n      setShowTyping(false);\n      if (message !== displayText) {\n        var _bubbleRef$current;\n        setDisplayText(message);\n        (_bubbleRef$current = bubbleRef.current) === null || _bubbleRef$current === void 0 ? void 0 : _bubbleRef$current.scrollIntoView({\n          behavior: 'smooth'\n        });\n      }\n    }\n  }, [message, isTyping]);\n  useEffect(() => {\n    if (!isTyping && !message.trim() && !error) {\n      setIsVisible(false);\n    }\n  }, [isTyping, message, error]);\n  if (!isVisible) return null;\n  return /*#__PURE__*/_jsxDEV(AnimatePresence, {\n    children: /*#__PURE__*/_jsxDEV(motion.div, {\n      ref: bubbleRef,\n      variants: messageVariants,\n      initial: \"initial\",\n      animate: \"animate\",\n      exit: \"exit\",\n      className: `flex ${isUser ? 'justify-end' : 'justify-start'} mb-4`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        \"data-testid\": \"message-bubble\",\n        className: `flex flex-col ${isUser ? 'items-end' : 'items-start'} max-w-[80%]`,\n        children: [!isUser && character && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm font-medium text-gray-400 mb-1 ml-1\",\n          children: [character.name, \" (\", character.movie, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n          className: `rounded-xl shadow-md px-6 py-4 ${error ? 'bg-red-50 border border-red-200' : isUser ? 'bg-chat-user-bg text-chat-user-text' : character ? 'bg-chat-bot-bg text-chat-bot-text' : 'bg-gray-700 text-gray-100'}`,\n          layout: true,\n          children: error ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm md:text-base text-red-600 font-medium\",\n            children: [\"Error: \", error]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 29\n          }, this) : showTyping && !displayText.trim() ? /*#__PURE__*/_jsxDEV(TypingIndicator, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"prose prose-invert max-w-none\",\n            children: /*#__PURE__*/_jsxDEV(ReactMarkdown, {\n              children: displayText\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 9\n  }, this);\n};\n_s(MessageBubble, \"Qrk0HBv0gviaZpDpSAilzw3Rko4=\");\n_c = MessageBubble;\nexport default MessageBubble;\nvar _c;\n$RefreshReg$(_c, \"MessageBubble\");","map":{"version":3,"names":["React","useEffect","useState","useRef","motion","AnimatePresence","messageVariants","TypingIndicator","ReactMarkdown","jsxDEV","_jsxDEV","MessageBubble","message","isUser","isTyping","character","error","_s","displayText","setDisplayText","showTyping","setShowTyping","isVisible","setIsVisible","bubbleRef","trim","_bubbleRef$current","current","scrollIntoView","behavior","children","div","ref","variants","initial","animate","exit","className","name","movie","fileName","_jsxFileName","lineNumber","columnNumber","layout","_c","$RefreshReg$"],"sources":["C:/Users/ajits/fastapi-react-chatbot/frontend/src/components/MessageBubble.tsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { messageVariants } from '../styles/variants';\r\nimport TypingIndicator from './TypingIndicator';\r\nimport ReactMarkdown from 'react-markdown';\r\n\r\ninterface Character {\r\n    id: number;\r\n    name: string;\r\n    movie: string;\r\n}\r\n\r\ninterface MessageBubbleProps {\r\n    message: string;\r\n    isUser: boolean;\r\n    isTyping?: boolean;\r\n    character?: Character;\r\n    error?: string;\r\n}\r\n\r\nconst MessageBubble: React.FC<MessageBubbleProps> = ({ \r\n    message, \r\n    isUser, \r\n    isTyping = false, \r\n    character,\r\n    error \r\n}) => {\r\n    const [displayText, setDisplayText] = useState('');\r\n    const [showTyping, setShowTyping] = useState(isTyping);\r\n    const [isVisible, setIsVisible] = useState(true);\r\n    const bubbleRef = useRef<HTMLDivElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (isTyping) {\r\n            setShowTyping(true);\r\n            if (!message.trim()) {\r\n                setDisplayText('');\r\n            }\r\n        } else {\r\n            setShowTyping(false);\r\n            if (message !== displayText) {\r\n                setDisplayText(message);\r\n                bubbleRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n            }\r\n        }\r\n    }, [message, isTyping]);\r\n\r\n    useEffect(() => {\r\n        if (!isTyping && !message.trim() && !error) {\r\n            setIsVisible(false);\r\n        }\r\n    }, [isTyping, message, error]);\r\n\r\n    if (!isVisible) return null;\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            <motion.div\r\n                ref={bubbleRef}\r\n                variants={messageVariants}\r\n                initial=\"initial\"\r\n                animate=\"animate\"\r\n                exit=\"exit\"\r\n                className={`flex ${isUser ? 'justify-end' : 'justify-start'} mb-4`}\r\n            >\r\n                <div \r\n                    data-testid=\"message-bubble\"\r\n                    className={`flex flex-col ${isUser ? 'items-end' : 'items-start'} max-w-[80%]`}\r\n                >\r\n                    {!isUser && character && (\r\n                        <span className=\"text-sm font-medium text-gray-400 mb-1 ml-1\">\r\n                            {character.name} ({character.movie})\r\n                        </span>\r\n                    )}\r\n                    <motion.div\r\n                        className={`rounded-xl shadow-md px-6 py-4 ${\r\n                            error ? 'bg-red-50 border border-red-200' :\r\n                            isUser\r\n                                ? 'bg-chat-user-bg text-chat-user-text'\r\n                                : character \r\n                                    ? 'bg-chat-bot-bg text-chat-bot-text'\r\n                                    : 'bg-gray-700 text-gray-100'\r\n                        }`}\r\n                        layout\r\n                    >\r\n                        {error ? (\r\n                            <p className=\"text-sm md:text-base text-red-600 font-medium\">\r\n                                Error: {error}\r\n                            </p>\r\n                        ) : showTyping && !displayText.trim() ? (\r\n                            <TypingIndicator />\r\n                        ) : (\r\n                            <div className=\"prose prose-invert max-w-none\">\r\n                                <ReactMarkdown>\r\n                                    {displayText}\r\n                                </ReactMarkdown>\r\n                            </div>\r\n                        )}\r\n                    </motion.div>\r\n                </div>\r\n            </motion.div>\r\n        </AnimatePresence>\r\n    );\r\n};\r\n\r\nexport default MessageBubble;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}